<html><head><meta charset="utf-8" /><script src="../siteTitle.js"></script><script src="../tab.js"></script><link rel="stylesheet" href="../grid.css"><title>JavaScript projects</title></head><body><div id="grid"><script src="./left.js"></script><div id="root"><p><script src="https://cdn.jsdelivr.net/npm/p5@1.6.0/lib/p5.js"></script></p><p><h1>p5 간단한 리듬게임</h1></p><p>이 작업은 p5.js로 만든 단순 타이밍 맞추기를 조금 더 발전시켜본 것입니다.<br>또한 자바 탭에 있는 노트 생성기와 연동되는 작업물 입니다.<br>오른쪽의 테스트를 누르면 노트가 떨어지며, 타이밍에 맞춰 키보드의 "s","d","f"," ","j","k","l"을 입력하면<br>점수와 HP가 변하게 됩니다.<br>예시곡을 누르면 웹 서버에 저장되어 있는 곡을 플레이 할 수 있고<br>음악파일과 그에 해당하는 노트파일을 올리면 나만의 곡으로도 플레이할 수 있습니다.<br>곡에 맞춰진 노트는 자바 탭의 노트 생성기를 이용하면 만들 수 있습니다.</p><p><script>function setup() {   frameRate(20);   createCanvas(450, 700);notex={"s":10,"d":55,"f":100," ":145,"j":190,"k":235,"l":280};   notesets = ["s","d","f"," ","j","k","l"];   keysets = [83,68,70,32,74,75,76];   noteshine = [0,0,0,0,0,0,0];   notespeed = 5;   score = 0;HP = 100;   songon = 0;flowtime = 0;   combo = 0;   outtext=[0,0,0];   note = [];   addsong=0;   inputsong = createFileInput(handlesongFile);   inputsong.position(350, 590);   inputnote = createFileInput(handlenoteFile);   inputnote.position(350, 650);   makednote =null;   newsong = null; } function handlesongFile(file){   newsong = createAudio(file.data); } function handlenoteFile(file){   newnote = file.data;   newnote = split(newnote,"  ");   makednote = [["songlength",newnote[0]]];   for (let i=1; i<newnote.length;i++){     makednote.push(split(newnote[i]," "));     makednote[i][0]=notesets[makednote[i][0]];}   console.log(makednote); }  function doubleClicked() {if (songon == 0){     if (mouseX > 340 && mouseX < 435 && mouseY > 400 && mouseY < 433){       songon = 1;       note = [["songlength",300],["s",44],["l",175],["j",180,200]];     }     else if (mouseX > 340 && mouseX < 435 && mouseY > 433 && mouseY < 466){       songon = 1;       note = [["songlength",771],["s",99],["s",100],["d",114],["d",115],["d",116],["f",122],[" ",140],["f",145],["f",146],["f",147],["s",161],["s",162],["d",163],["f",167],["f",168],["f",169],["j",188],["j",189],["j",190],["k",205],["k",206],["k",207],["l",211],["l",212],["l",213],["k",229],["k",230],["k",231],["j",236],["k",251],["k",252],[" ",256],[" ",257],["k",267],[" ",268],[" ",269],["j",278],["j",279],["f",300],["l",306],["l",307],["s",322],["s",323],["s",324],[" ",328],[" ",329],["d",342],["d",343],["d",344],["f",348],["f",349],["l",370],["l",371],["l",372],["k",386],["k",387],["k",388],["j",392],[" ",410],[" ",411],["d",415],["d",416],["d",417],["f",436],["l",437],["l",438],["l",439],["j",447],["j",448],["j",449],["f",459],["f",460],["f",461],["f",476],["f",477],["f",478],["l",482],["l",483],["l",484],["l",499],["l",500],["l",501],["j",505],["j",506],["j",507],["d",522],["d",523],["d",524],["j",527],["j",528],["k",529],["l",532],["k",550],["k",551],["k",552],["l",567],["l",568],["f",573],["f",574],["f",575],[" ",590],[" ",591],[" ",592],["s",596],["s",597],["s",598],["k",612],["k",613],["k",614],["d",617],["d",618],["j",629],["l",630],["l",631],["f",641],["f",642],["f",643],["k",658],["k",659],["d",663],["d",664],["l",682],["f",686],["f",687],["k",703],["k",704],["l",708],["l",709],["k",710],["j",712],[" ",713],[" ",714],["f",716],["f",717],["s",718]];       audio = new Audio('./p5rhythm_example.wav');       audio.play();     }     else if (mouseX > 340 && mouseX < 435 && mouseY > 466 && mouseY < 500){       if (makednote !=null && newsong!= null){         songon = 1;         for (let i =0;i<makednote.length;i++){           note.push(makednote[i]);}         audio = newsong;         audio.play();         }            }   } } function draw() {   backprint();   if (songon == 1){     if (note.length>0 && note[0][0] == "songlength"){songlength=note[0][1];       note.splice(0,1);}     noteprint();     keyprint();     if (HP<1){songon = 0;note=[];audio.stop();audio=null;}     if (flowtime==songlength){songon = 0;}}   else{     flowtime=0;     HP=100;     score=0;}}  function keyshine(x){   fill(255,255,255,100);   rect(x,590,40,10);   fill(255,255,255,70);   rect(x,580,40,10);   fill(255,255,255,40);   rect(x,570,40,10);   fill(255,255,255,10);   rect(x,560,40,10); } function backprint(){   background([250,100,150]);   fill(0,0,0);   rect(10,0,315,800);   fill(250,100,150,175);   rect(10,600,315,10);   fill(250,100,150);   rect(50,0,5,800);   rect(95,0,5,800);   rect(140,0,5,800);   rect(185,0,5,800);   rect(230,0,5,800);   rect(275,0,5,800);   fill(0,0,0);   textSize(30);   stroke(255,255,255);   strokeWeight(2);   text("Score",340,50);   text("HP",340,170);   textSize(40);   text(score,340,100);   stroke(0);   fill(0,0,0);   rect(340,200,30,100-HP);   fill(0,250,0);   rect(340,200+100-HP,30,HP);   fill(250,200,225,200);   rect(340,400,95,100);   fill(0,0,0);   textSize(15);   text("테스트",345,420);   text("예시곡",345,450);   text("음악파일 추가",350,580);   text("노트파일 추가",350,640);   if (makednote != null && newsong != null){text("추가된 곡",345,480);}} function noteprint(){   notei = 0;   while (notei<note.length){     if (flowtime-note[notei][1]==7){       combo=0;       HP-=3;       score-=5;       outtext = ["Bad..",25,[100,100,100,100]];     }     else if ((flowtime-note[notei][1])>7) {       fill(100,100,100);}     else if ((flowtime-note[notei][1])*notespeed>=-600){       fill(250,200,225);}     else{break;}     if (note[notei].length == 2){       rect(notex[note[notei][0]],(flowtime-note[notei][1])*notespeed+600,40,10,10);}     else{       rect(notex[note[notei][0]],(flowtime-note[notei][2])*notespeed+600,40,(note[notei][2]-note[notei][1])*notespeed,10);}       notei+=1;}   notei=0;   while (notei<note.length){     if ((flowtime-note[notei][1])*notespeed>200){note.splice(notei,1);       notei-=1;}     else{break;}     notei+=1;}} function keyprint(){   for (let i=0;i<notesets.length;i++){     if (keyIsDown(keysets[i])){       noteshine[i] = 5;       for (let j = 0; j<note.length && j<7; j++){         if (note[j][0] == notesets[i]){           if (note[j][1] == flowtime-10){             combo +=1;             score +=5+combo;             HP +=1;             outtext = ["Perfect!",25,[250,100,150,100]];}           else if (note[j][1]>flowtime-15 && note[j][1]<flowtime-5){             combo +=1;             score +=3+combo;             HP +=1;             outtext = ["Great!",25,[100,150,250,100]];}           else if (note[j][1]>flowtime-20 && note[j][1]<flowtime){             combo +=1;             score +=2+combo;             HP +=1;             outtext = ["Good",25,[100,250,150,100]];}           else{             combo =0;             outtext = ["Bad..",25,[100,100,100,100]];             break;}           if (note[j].length == 2){             note.splice(j,1);}           else{             note[j][1] = flowtime-1;             if (note[j][1] ==note[j][2]){note.splice(j,1);}}           break;}         outtext = ["Bad..",25,[100,100,100,100]];}}}   if (keyIsDown(UP_ARROW) &&notespeed<9){notespeed+=2;}   else if (keyIsDown(DOWN_ARROW) &&notespeed>1){notespeed-=2;}   for (let i = 0; i<noteshine.length;i++){     if (noteshine[i]>0){keyshine(notex[notesets[i]]);       noteshine[i]-=1;}}   if (outtext[1]>0){     fill(outtext[2][0],outtext[2][1],outtext[2][2]);     textSize(20);     text(outtext[0],160,180);     if (combo>0){       text(combo,160,200);       text("combo!",180,200);}     outtext[1]-=1;}   flowtime+=1;}</script></p><p>첨부파일 : <a href="./p5rhythm.zip" download="Kyus_p5rhythm.zip">Kyus_p5rhythm.zip</a></p></div></div></body></html>